"use strict";(self["webpackChunkyy_shop"]=self["webpackChunkyy_shop"]||[]).push([[369],{49114:function(e,l,t){t.d(l,{Z:function(){return c}});var a=t(66252),r=t(2262),s=t(3577);const i={style:{width:"100%",height:"100%",display:"flex"}},o=["onClick"];var n={__name:"Scrollbar",props:{labels:{type:Array,default:()=>[]}},emits:["handleClick"],setup(e,{emit:l}){const t=e,{labels:n}=(0,r.toRefs)(t),u=(0,r.ref)(0),g=e=>{u.value=e,l("handleClick",e)};return(e,l)=>{const t=(0,a.up)("el-scrollbar");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a.Wm)(t,{class:"scro_left","min-size":400},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((0,r.unref)(n),((e,l)=>((0,a.wg)(),(0,a.iD)("div",{class:(0,s.normalizeClass)([{left_list_click:u.value==l},"left_list"]),key:l,onClick:e=>g(l)},(0,s.toDisplayString)(e.yyfName),11,o)))),128))])),_:1}),(0,a.Wm)(t,{"min-size":400,class:"scro_right"},{default:(0,a.w5)((()=>[(0,a.WI)(e.$slots,"default")])),_:3})])}}},u=t(83744);const g=(0,u.Z)(n,[["__scopeId","data-v-31f29bba"]]);var c=g},55369:function(e,l,t){t.r(l),t.d(l,{default:function(){return N}});t(57658);var a=t(66252),r=t(3577),s=t(2262),i=t(65781),o=t(49114),n=t(22201);const u=e=>((0,a.dD)("data-v-ac5e2992"),e=e(),(0,a.Cn)(),e),g=u((()=>(0,a._)("div",{class:"top"},[(0,a._)("div",null,"设备源")],-1))),c={class:"right_title"},d={style:{"font-weight":"bolder"}},y={class:"right_reg"},p={class:"right_reg_title"},_=u((()=>(0,a._)("p",null,"正则表达式：",-1))),f={class:"right_reg_content"},m={class:"showReg"},h={class:"right_reg_btn"},v={class:"right_data"},w={class:"content_old"},k={class:"content_results"},b=u((()=>(0,a._)("p",{style:{height:"50px","line-height":"50px"}},"正则结果:  ",-1))),D=["onClick"],S={class:"btn_add"},C={class:"a_reg"},H={class:"test_reg"},W={class:"test_result"},R=u((()=>(0,a._)("br",null,null,-1))),L={class:"item_button"},U={class:"dialog-footer"};var V={__name:"SublevelView",setup(e){const l=(0,n.tv)(),{proxy:t}=(0,a.FN)(),u=(0,s.reactive)([]),V=(0,s.reactive)({regList:[],logList:[]}),x=(0,s.ref)(!1),$=(0,s.reactive)({regs:[{yyrName:"",yyrRegular:""}]}),N=(0,s.reactive)([]),Y={yyrHost:"",yyrFacility:""},F=(0,s.reactive)([]),K=(0,s.ref)("");(0,a.bv)((()=>{z()}));const z=async()=>{const{data:e}=await t.$http.BasicsService.getOlist();if(200!==e.code)return t.$message.error("获取数据源列表失败");u.length=0;for(let l=0;l<e.data.length;l++)u.push(e.data[l]);Y.yyrHost=u[0].yyfHost,B.value=u[0].yyfName,Y.yyrFacility=u[0].yyfFacility,q(),Z()},B=(0,s.ref)(""),I=e=>{B.value=u[e].yyfName,Y.facility=u[e].yyfFacility,Y.host=u[e].yyfHost,console.log(Y),q(),Z()},Z=async()=>{const{data:e}=await t.$http.SublevelService.getAllSubReg({facility:Y.yyrFacility,host:Y.yyrHost});if(200!==e.code)return t.$message.error("获取初始化数据错误");V.logList.length=0;for(let l=0;l<e.data.length;l++)V.logList.push(e.data[l])},q=async()=>{const{data:e}=await t.$http.SublevelService.getReg(Y);if(200!==e.code)return t.$message.error("获取正则失败");V.regList.length=0;for(let l=0;l<e.data.length;l++)e.data[l].rule="go",V.regList.push(e.data[l])},A=()=>{if(0!==V.regList.length){$.regs.length=0;for(let e=0;e<V.regList.length;e++)$.regs.push(V.regList[e])}x.value=!0},O=()=>{x.value=!1},j=()=>{K.value.validate((async e=>{if(!e)return;for(let t=0;t<$.regs.length;t++)$.regs[t].yyrHost=Y.yyrHost,$.regs[t].yyrFacility=Y.yyrFacility;const{data:l}=await t.$http.SublevelService.addReg($.regs);if(200!==l.code)return t.$message.error("修改正则失败");t.$message.success("修改正则成功"),q(),Z(),x.value=!1}))},T=(0,s.ref)(""),E=()=>{$.regs.push({yyrName:"",yyrRegular:""})},G=e=>{const l=$.regs.indexOf(e);-1!==l&&$.regs.splice(l,1)},J=e=>{""!==$.regs[e].yyrRegular&&""!==$.regs[e].yyrName?$.regs[e].rule="go":$.regs[e].rule=""},M=async()=>{const{data:e}=await t.$http.SublevelService.testReg({msg:T.value,regularDtoList:$.regs});if(console.log(e),200!==e.code)return t.$message.error("获取测试结果失败");F.length=0;for(let l=0;l<e.data.length;l++)F.push(e.data[l])},P=e=>{const t=l.resolve({path:"/detail",query:{item:e,...Y}});window.open(t.href,"_blank")};return(e,l)=>{const t=(0,a.up)("el-button"),n=(0,a.up)("el-input"),Y=(0,a.up)("el-form-item"),z=(0,a.up)("el-form"),Z=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.iD)("div",null,[g,(0,a.Wm)(o.Z,{labels:u,onHandleClick:I},{default:(0,a.w5)((()=>[(0,a._)("div",c,[(0,a.Uk)("所有数据均来自于数据源："),(0,a._)("p",d,(0,r.toDisplayString)(B.value),1)]),(0,a._)("div",y,[(0,a._)("div",p,[_,(0,a._)("div",f,[(0,a._)("div",m,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(V.regList,((e,l)=>((0,a.wg)(),(0,a.iD)("p",{key:l},(0,r.toDisplayString)(e.yyrName)+" : "+(0,r.toDisplayString)(e.yyrRegular),1)))),128))]),(0,a._)("p",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(V.regList,((e,l)=>((0,a.wg)(),(0,a.iD)(a.HY,{key:l},[(0,a.Uk)((0,r.toDisplayString)(e.yyrName)+" : "+(0,r.toDisplayString)(e.yyrRegular)+"    ",1)],64)))),128))])])]),(0,a._)("div",h,[(0,a.Wm)(t,{icon:(0,s.unref)(i.I8b),title:"修改正则",onClick:A},null,8,["icon"])])]),(0,a._)("div",v,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(V.logList,((e,l)=>((0,a.wg)(),(0,a.iD)("div",{key:l,class:"content_box"},[(0,a._)("div",w,"正则规则："+(0,r.toDisplayString)(e.regularKey),1),(0,a._)("div",k,[b,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.regularValues,((e,l)=>((0,a.wg)(),(0,a.iD)(a.HY,{key:l},[""!==e?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"content_result",onClick:l=>P(e)},(0,r.toDisplayString)(e),9,D)):(0,a.kq)("",!0)],64)))),128))])])))),128))])])),_:1},8,["labels"]),(0,a.Wm)(Z,{title:"修 改 正 则 规 则","model-value":x.value,"close-on-click-modal":!1,width:"50%",onClose:O},{default:(0,a.w5)((()=>[(0,a.Wm)(z,{"label-width":"30%",model:$,rules:N,"status-icon":"",ref_key:"cgThisRegRef",ref:K},{default:(0,a.w5)((()=>[(0,a.Wm)(Y,{prop:"log",label:"日志原文："},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:T.value,"onUpdate:modelValue":l[0]||(l[0]=e=>T.value=e)},null,8,["modelValue"])])),_:1}),(0,a._)("div",S,[(0,a.Wm)(t,{onClick:E,style:{"margin-bottom":"10px",right:"0","font-size":"0.35rem",width:"30px",height:"30px"},title:"添加正则"},{default:(0,a.w5)((()=>[(0,a.Uk)("+ ")])),_:1})]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)($.regs,((e,l)=>((0,a.wg)(),(0,a.j4)(Y,{key:l,label:"正则"+(l+1)+"：",prop:"regs."+l+".rule",rules:{required:!0,message:"正则名称和规则不能为空",trigger:"blur"}},{default:(0,a.w5)((()=>[(0,a._)("div",C,[(0,a.Wm)(n,{placeholder:"正则名",modelValue:e.yyrName,"onUpdate:modelValue":l=>e.yyrName=l,style:{width:"25%"},onBlur:e=>J(l)},null,8,["modelValue","onUpdate:modelValue","onBlur"]),(0,a.Wm)(n,{placeholder:"正则规则",modelValue:e.yyrRegular,"onUpdate:modelValue":l=>e.yyrRegular=l,style:{width:"60%"},onBlur:e=>J(l)},null,8,["modelValue","onUpdate:modelValue","onBlur"]),(0,a.Wm)(t,{disabled:0===l,onClick:l=>G(e),title:"删除正则",style:{width:"30px",height:"30px","font-size":"0.35rem","line-height":"10px"}},{default:(0,a.w5)((()=>[(0,a.Uk)("- ")])),_:2},1032,["disabled","onClick"])])])),_:2},1032,["label","prop"])))),128)),(0,a._)("div",H,[(0,a.Wm)(t,{onClick:M},{default:(0,a.w5)((()=>[(0,a.Uk)("测试结果")])),_:1}),(0,a._)("div",W,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(F,((e,l)=>((0,a.wg)(),(0,a.iD)("span",{key:l},[(0,a.Uk)((0,r.toDisplayString)(e.name)+" : "+(0,r.toDisplayString)(e.value),1),R])))),128))])]),(0,a._)("div",L,[(0,a._)("span",U,[(0,a.Wm)(t,{onClick:l[1]||(l[1]=e=>x.value=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1}),(0,a.Wm)(t,{type:"primary",onClick:j},{default:(0,a.w5)((()=>[(0,a.Uk)("确 定")])),_:1})])])])),_:1},8,["model","rules"])])),_:1},8,["model-value"])])}}},x=t(83744);const $=(0,x.Z)(V,[["__scopeId","data-v-ac5e2992"]]);var N=$}}]);
//# sourceMappingURL=369.2d31db97.js.map